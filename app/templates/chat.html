{% extends "base.html" %}

{% block title %}Chat - Pokemon Chat App{% endblock %}

{% block content %}
<div class="chat-container">
    <div class="chat-sidebar" id="chat-sidebar">
        <!-- Mobile drawer content -->
        <div class="mobile-team-drawer">
            <div class="drawer-handle" onclick="toggleMobileTeam()"></div>
            <div class="mobile-team-header">
                <h3>Select Pokemon</h3>
                <button class="mobile-team-close" onclick="toggleMobileTeam()">&times;</button>
            </div>
            <div class="team-list" id="team-list">
                <!-- Team Pokemon will be displayed here -->
            </div>
            <div class="sidebar-empty hidden" id="sidebar-empty">
                <p>No team members yet</p>
                <a href="/pokedex" class="btn btn-small">Build Team</a>
            </div>
        </div>
    </div>

    <div class="chat-main">
        <div class="chat-header" id="chat-header">
            <div class="chat-header-content">
                <div class="chat-pokemon-sprite" id="current-pokemon-sprite">
                    <!-- Pokemon sprite will be displayed here -->
                </div>
                <div class="chat-pokemon-info">
                    <h3 id="current-pokemon-name">Select a Pokemon to chat</h3>
                    <span id="current-pokemon-details"></span>
                </div>
            </div>
            <!-- Mobile pull indicator -->
            <div class="mobile-pull-indicator">
                <svg width="16" height="10" viewBox="0 0 16 10" fill="none">
                    <path d="M2 2L8 8L14 2" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
            </div>
            <div class="chat-actions">
                <!-- Mobile minimal action buttons -->
                <button class="mobile-action-btn" onclick="window.location.href='/pokedex'" title="Pokedex">
                    üì±
                </button>
                <button class="mobile-action-btn" onclick="window.location.href='/import'" title="Import">
                    üìÅ
                </button>
                <button class="mobile-team-toggle" id="mobile-team-toggle" onclick="toggleMobileTeam()" style="display: none;" title="Switch Pokemon">
                    üë•
                </button>
                <button class="mobile-action-btn" id="clear-chat-btn" onclick="clearChatHistory()" style="display: none;" title="Clear History">
                    üóëÔ∏è
                </button>
            </div>
        </div>

        <div class="chat-messages" id="chat-messages">
            <div class="chat-welcome" id="chat-welcome">
                <h3>Welcome to PokeChat!</h3>
                <p>Select a Pokemon from your team on the left to start chatting.</p>
                <p>If you don't have any team members yet, visit the <a href="/pokedex">Pokedex</a> to build your team.</p>
            </div>
        </div>

        <div class="chat-input-container" id="chat-input-container" style="display: none;">
            <form class="chat-form" onsubmit="sendMessage(event)">
                <input type="text" id="message-input" placeholder="Type your message..." class="chat-input" autocomplete="off">
                <button type="submit" class="send-btn">Send</button>
            </form>
        </div>

        <div class="typing-indicator hidden" id="typing-indicator">
            <div class="typing-dots">
                <span></span>
                <span></span>
                <span></span>
            </div>
            <span id="typing-pokemon">Pokemon is typing...</span>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/chat.js') }}"></script>
{% endblock %}